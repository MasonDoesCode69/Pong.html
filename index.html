<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Neon Pong vs. Mark</title>
    <style>
        body { background: #050505; color: #fff; font-family: 'Courier New', monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        #game-container { position: relative; border: 4px solid #0ff; box-shadow: 0 0 20px #0ff; }
        canvas { background: transparent; display: block; }
        #ui { position: absolute; top: -60px; width: 100%; display: flex; justify-content: space-between; font-size: 28px; text-shadow: 0 0 10px #0ff; color: #0ff; }
        #dialogue-box { margin-top: 20px; height: 50px; text-align: center; color: #f0f; font-weight: bold; width: 600px; text-shadow: 0 0 10px #f0f; font-size: 20px; }
        .controls { margin-top: 15px; color: #444; font-size: 14px; }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="ui">
            <span>HUMAN: <span id="pScore">0</span></span>
            <span>MARK: <span id="mScore">0</span></span>
        </div>
        <canvas id="pong" width="800" height="400"></canvas>
    </div>

    <div id="dialogue-box">"Ready to witness peak performance?"</div>
    <div class="controls">Controls: Use ↑/↓ Arrows or W/S Keys.</div>

<script>
    const canvas = document.getElementById("pong");
    const ctx = canvas.getContext("2d");
    const dialogueBox = document.getElementById("dialogue-box");
    const pScoreEl = document.getElementById("pScore");
    const mScoreEl = document.getElementById("mScore");

    let pScore = 0, mScore = 0;
    const keys = {};

    const player = { x: 10, y: 150, w: 10, h: 100, color: "#0ff", speed: 8 };
    const mark = { x: 780, y: 150, w: 10, h: 100, color: "#f0f", speed: 4.5 }; // AI Speed capped to be beatable
    const ball = { x: 400, y: 200, r: 8, speed: 6, dx: 6, dy: 6, color: "#fff" };

    const markQuotes = {
        miss: ["LAG! I call lag!", "I was distracted by a background process.", "Impossible... calculating retry...", "You got lucky, meatbag."],
        score: ["Too predictable.", "My calculations are perfect.", "Is this your 'skill'?", "01001100-oser."],
        taunt: ["I see your move before you think it.", "Your CPU is ancient.", "I'm playing at 1% power.", "Nice pixels."]
    };

    window.addEventListener("keydown", e => keys[e.key] = true);
    window.addEventListener("keyup", e => keys[e.key] = false);

    function say(type) {
        const lines = markQuotes[type];
        dialogueBox.innerText = `Mark: "${lines[Math.floor(Math.random() * lines.length)]}"`;
    }

    function resetBall() {
        ball.x = canvas.width / 2;
        ball.y = canvas.height / 2;
        ball.dx *= -1;
        ball.speed = 6;
    }

    function drawGlowRect(x, y, w, h, color) {
        ctx.shadowBlur = 15;
        ctx.shadowColor = color;
        ctx.fillStyle = color;
        ctx.fillRect(x, y, w, h);
        ctx.shadowBlur = 0; // Reset for performance
    }

    function update() {
        // Player Movement
        if ((keys["ArrowUp"] || keys["w"]) && player.y > 0) player.y -= player.speed;
        if ((keys["ArrowDown"] || keys["s"]) && player.y < canvas.height - player.h) player.y += player.speed;

        // Ball Physics
        ball.x += ball.dx;
        ball.y += ball.dy;

        // Beatable Mark AI: Capped movement speed and slight error
        let markCenter = mark.y + mark.h / 2;
        if (markCenter < ball.y - 10) mark.y += mark.speed;
        else if (markCenter > ball.y + 10) mark.y -= mark.speed;

        // Wall Bouncing
        if (ball.y + ball.r > canvas.height || ball.y - ball.r < 0) ball.dy *= -1;

        // Collision Logic
        let paddle = (ball.x < canvas.width / 2) ? player : mark;
        if (collision(ball, paddle)) {
            let collidePoint = (ball.y - (paddle.y + paddle.h / 2)) / (paddle.h / 2);
            let angleRad = (Math.PI / 4) * collidePoint;
            let direction = (ball.x < canvas.width / 2) ? 1 : -1;
            ball.dx = direction * ball.speed * Math.cos(angleRad);
            ball.dy = ball.speed * Math.sin(angleRad);
            ball.speed += 0.3;
            if (paddle === mark && Math.random() > 0.8) say("taunt");
        }

        // Scoring
        if (ball.x < 0) { mScore++; mScoreEl.innerText = mScore; say("score"); resetBall(); }
        else if (ball.x > canvas.width) { pScore++; pScoreEl.innerText = pScore; say("miss"); resetBall(); }
    }

    function collision(b, p) {
        return b.x + b.r > p.x && b.x - b.r < p.x + p.w && b.y + b.r > p.y && b.y - b.r < p.y + p.h;
    }

    function render() {
        // Trail Effect: Don't clear fully, leave 15% opacity of previous frame
        ctx.fillStyle = "rgba(5, 5, 5, 0.15)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Draw Paddles
        drawGlowRect(player.x, player.y, player.w, player.h, player.color);
        drawGlowRect(mark.x, mark.y, mark.w, mark.h, mark.color);

        // Draw Ball
        ctx.shadowBlur = 20;
        ctx.shadowColor = "#fff";
        ctx.fillStyle = "#fff";
        ctx.beginPath();
        ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0;

        // Center Line
        ctx.strokeStyle = "rgba(0, 255, 255, 0.1)";
        ctx.setLineDash([10, 10]);
        ctx.beginPath();
        ctx.moveTo(canvas.width / 2, 0);
        ctx.lineTo(canvas.width / 2, canvas.height);
        ctx.stroke();
    }

    function gameLoop() { update(); render(); requestAnimationFrame(gameLoop); }
    gameLoop();
</script>
</body>
</html>
